
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Documentation &#8212; kle-py</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/style.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="canonical" href="/kle-py/documentation.html" />
    <link rel="shortcut icon" href="_static/logo.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="damsenviet.kle package" href="api/damsenviet.kle.html" />
    <link rel="prev" title="Guide" href="guide.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    <a class="navbar-brand" href="index.html">
    
      <img src="_static/logo-text.svg" class="logo" alt="logo" />
    
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="guide.html">Guide</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="">Documentation</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="api/damsenviet.kle.html">API</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/DamSenViet/kle-py" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

    <div class="bd-toc-item active">
    
  
    <ul class="nav bd-sidenav">
        
        
        
        
          
        
        
        
        
      </ul>
  
  </nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#precision" class="nav-link">Precision</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#invariants" class="nav-link">Invariants</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#deterministic" class="nav-link">Deterministic</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#the-kle-format" class="nav-link">The KLE Format</a>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="documentation">
<h1>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h1>
<p>This library provides comprehensive apis to serialize/deserialize and access
KLE data. While being a port of KLE’s official code, it provides improvements
to prevent needing to evaluate redirected values. With this library, no
evaluation on redirected values needs to be performed, as the redirected values
have been unpacked into the data structures.</p>
<div class="section" id="precision">
<h2>Precision<a class="headerlink" href="#precision" title="Permalink to this headline">¶</a></h2>
<p>This library uses arbitrary math precision libraries, but uses specific
precision when serializing and deserializing. To maintain precision on
mathematical operations, utilize the decimal’s Decimal constructor with
strings.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
<span class="kn">from</span> <span class="nn">damsenviet.kle</span> <span class="kn">import</span> <span class="n">Key</span>

<span class="c1"># str native float values to prevent inprecision from affecting Decimal</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">Key</span><span class="p">()</span>
<span class="n">key</span><span class="o">.</span><span class="n">x</span> <span class="o">+=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mf">1.2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="invariants">
<h2>Invariants<a class="headerlink" href="#invariants" title="Permalink to this headline">¶</a></h2>
<p>Any invariants that cannot be maintained by KLE will not be enforced in this
library for the sake of consistency (e.g. colors can be invalid string
representations). Generic types however are enforced on the properties.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">decimal</span> <span class="kn">import</span> <span class="n">Decimal</span>
<span class="kn">from</span> <span class="nn">damsenviet</span> <span class="kn">import</span> <span class="n">Key</span>

<span class="n">key</span> <span class="o">=</span> <span class="n">Key</span><span class="p">()</span>

<span class="c1"># throws error</span>
<span class="n">key</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;wow&quot;</span>
<span class="n">key</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s2">&quot;oops&quot;</span>
<span class="c1"># perfectly fine</span>
<span class="n">key</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">key</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="o">-</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="c1"># kle doesn&#39;t correct negative numbers</span>

<span class="c1"># throws error, only takes numbers</span>
<span class="n">key</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># success</span>
<span class="n">key</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#000000&quot;</span>
<span class="n">key</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;asdjfljasdlfjl;aksdjflk&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="deterministic">
<h2>Deterministic<a class="headerlink" href="#deterministic" title="Permalink to this headline">¶</a></h2>
<p>The primary property this library maintains is that any KLE file deserialized
in this library can be serialized back into an equivalent json.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">damsenviet.kle</span> <span class="kn">import</span> <span class="n">Keyboard</span>

<span class="c1"># relative to this file</span>
<span class="n">json_relative_file_path</span> <span class="o">=</span> <span class="s2">&quot;./keyboard.json&quot;</span>
<span class="n">json_absolute_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span>
        <span class="n">json_relative_file_path</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">keyboard_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_absolute_file_path</span><span class="p">)</span>
<span class="n">keyboard</span> <span class="o">=</span> <span class="n">Keyboard</span><span class="o">.</span><span class="n">from_json</span><span class="p">(</span><span class="n">keyboard_json</span><span class="p">)</span>
<span class="k">assert</span><span class="p">(</span><span class="n">kle_json</span> <span class="o">==</span> <span class="n">keyboard</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span> <span class="c1"># true</span>
</pre></div>
</div>
</div>
<div class="section" id="the-kle-format">
<h2>The KLE Format<a class="headerlink" href="#the-kle-format" title="Permalink to this headline">¶</a></h2>
<p>KLE’s JSON serial format was designed to help minimize it’s file size and not
ease of use. The JSON serial records the running changes as opposed to
individual key dictionaries.</p>
<p>Specific values like empty strings or 0’s are flags to developers to check the
default value which is used to help optimize the final changes, but put
an additional burden on developers who try to access the data.</p>
<p>The format is composed of a optional metadata JSON object as a first item.
Every item after the first metadata object in the JSON must be an array.These
arrays can contain objects that record key property changes or strings that
represent labels. Some of these key properties changes and labels have been
reordered to minimize file size and therefore need to be unaligned before
being put into data structures.</p>
<p>Not all objects in the arrays represent key property changes however, some are
boolean properties that only apply to the following key after it (e.g. ‘g’
property for ghosted keys is an example of this).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="c1"># relative to this file</span>
<span class="n">json_relative_file_path</span> <span class="o">=</span> <span class="s2">&quot;./keyboard.json&quot;</span>
<span class="n">json_absolute_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span>
    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span>
        <span class="n">json_relative_file_path</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>


              </div>
              
              
          </main>
          

      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2020, damsenviet.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>